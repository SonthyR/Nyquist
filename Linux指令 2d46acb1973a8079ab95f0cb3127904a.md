# Linux指令

# 系统重装+优化

ssh系统重装：

- 
    
    ```jsx
    wget --no-check-certificate -qO InstallNET.sh 'https://raw.githubusercontent.com/leitbogioro/Tools/master/Linux_reinstall/InstallNET.sh' && chmod a+x InstallNET.sh && bash InstallNET.sh -debian 12 -pwd '154321tt'
    ```
    

优化代码

- 
    
    ```bash
    cat > optimize.sh << 'EOF'
    #!/bin/bash
    GREEN="\033[32m"
    PLAIN="\033[0m"
    
    echo -e "${GREEN}>>> [1/4] 开始系统更新...${PLAIN}"
    apt update -y && apt full-upgrade -y && apt autoremove -y
    
    echo -e "${GREEN}>>> [2/4] 安装常用工具...${PLAIN}"
    apt install -y curl wget vim git htop unzip tar socat net-tools ca-certificates
    
    echo -e "${GREEN}>>> [3/4] 开启 BBR 加速...${PLAIN}"
    if ! lsmod | grep -q bbr; then
        echo "net.core.default_qdisc=fq" >> /etc/sysctl.conf
        echo "net.ipv4.tcp_congestion_control=bbr" >> /etc/sysctl.conf
        sysctl -p > /dev/null 2>&1
    fi
    
    echo -e "${GREEN}>>> [4/4] 优化系统参数...${PLAIN}"
    # 优化文件打开数
    grep -q "soft nofile 65535" /etc/security/limits.conf || echo "* soft nofile 65535" >> /etc/security/limits.conf
    grep -q "hard nofile 65535" /etc/security/limits.conf || echo "* hard nofile 65535" >> /etc/security/limits.conf
    
    # 优化内核参数
    cat >> /etc/sysctl.conf << sysEOF
    net.ipv4.ip_forward = 1
    net.ipv4.tcp_slow_start_after_idle = 0
    net.ipv4.tcp_no_metrics_save = 1
    net.ipv4.tcp_fin_timeout = 30
    net.ipv4.tcp_keepalive_time = 1200
    net.core.somaxconn = 32768
    net.ipv4.tcp_max_syn_backlog = 8192
    net.ipv4.tcp_fastopen = 3
    sysEOF
    sysctl -p > /dev/null 2>&1
    
    echo ""
    echo "------------------------------------------------"
    echo "系统更新完成，常用工具安装完成，已开启BBR，优化系统完成。"
    echo "------------------------------------------------"
    EOF
    bash optimize.sh && rm optimize.sh
    ```
    

优化代码升级版

- 
    
    ```bash
    cat > optimize.sh << 'EOF'
    #!/bin/bash
    GREEN="\033[32m"
    PLAIN="\033[0m"
    
    # -----------------------------------------------------------------------------
    # 1. 系统更新
    # -----------------------------------------------------------------------------
    echo -e "${GREEN}>>> [1/6] 开始系统更新...${PLAIN}"
    apt update -y && apt full-upgrade -y && apt autoremove -y
    
    # -----------------------------------------------------------------------------
    # 2. 安装常用工具
    # -----------------------------------------------------------------------------
    echo -e "${GREEN}>>> [2/6] 安装常用工具...${PLAIN}"
    apt install -y curl wget vim git htop unzip tar socat net-tools ca-certificates
    
    # -----------------------------------------------------------------------------
    # 3. 设置时区为上海 (CST)
    # -----------------------------------------------------------------------------
    echo -e "${GREEN}>>> [3/6] 设置时区为 Asia/Shanghai...${PLAIN}"
    timedatectl set-timezone Asia/Shanghai
    echo "当前时间: $(date)"
    
    # -----------------------------------------------------------------------------
    # 4. 自动增加 Swap (如果内存小于2G，添加2G Swap)
    # -----------------------------------------------------------------------------
    echo -e "${GREEN}>>> [4/6] 检查并配置 SWAP 虚拟内存...${PLAIN}"
    # 只有当没有 swap 且内存较小时才添加
    if [ $(free -m | grep Swap | awk '{print $2}') -eq 0 ]; then
        echo "正在创建 2GB Swap 文件..."
        fallocate -l 2G /swapfile
        chmod 600 /swapfile
        mkswap /swapfile
        swapon /swapfile
        echo '/swapfile none swap sw 0 0' >> /etc/fstab
        echo "Swap 创建成功。"
    else
        echo "Swap 已存在，跳过。"
    fi
    
    # -----------------------------------------------------------------------------
    # 5. 开启 BBR
    # -----------------------------------------------------------------------------
    echo -e "${GREEN}>>> [5/6] 开启 BBR 加速...${PLAIN}"
    if ! lsmod | grep -q bbr; then
        echo "net.core.default_qdisc=fq" >> /etc/sysctl.conf
        echo "net.ipv4.tcp_congestion_control=bbr" >> /etc/sysctl.conf
        sysctl -p > /dev/null 2>&1
    fi
    
    # -----------------------------------------------------------------------------
    # 6. 优化系统参数
    # -----------------------------------------------------------------------------
    echo -e "${GREEN}>>> [6/6] 优化系统参数...${PLAIN}"
    grep -q "soft nofile 65535" /etc/security/limits.conf || echo "* soft nofile 65535" >> /etc/security/limits.conf
    grep -q "hard nofile 65535" /etc/security/limits.conf || echo "* hard nofile 65535" >> /etc/security/limits.conf
    
    cat >> /etc/sysctl.conf << sysEOF
    net.ipv4.ip_forward = 1
    net.ipv4.tcp_slow_start_after_idle = 0
    net.ipv4.tcp_no_metrics_save = 1
    net.ipv4.tcp_fin_timeout = 30
    net.ipv4.tcp_keepalive_time = 1200
    net.core.somaxconn = 32768
    net.ipv4.tcp_max_syn_backlog = 8192
    net.ipv4.tcp_fastopen = 3
    sysEOF
    sysctl -p > /dev/null 2>&1
    
    echo ""
    echo "------------------------------------------------"
    echo "✅ 系统更新完成"
    echo "✅ 常用工具安装完成"
    echo "✅ 时区已设为上海"
    echo "✅ 虚拟内存(Swap)配置完成"
    echo "✅ BBR 已开启"
    echo "✅ 系统参数优化完成"
    echo "------------------------------------------------"
    EOF
    bash optimize.sh && rm optimize.sh
    ```
    

防火墙

- 
    
    ```bash
    apt update && apt install -y ufw
    ufw allow 22
    ufw allow 4033
    ufw allow 80
    ufw allow 443
    ufw enable
    ```
    
    ```bash
    apt update && apt install -y ufw && ufw allow 22 && ufw allow 4033 && ufw allow 80 && ufw allow 443 && ufw --force enable
    
    ufw allow
    
    ufw status
    ```
    

BBR

- 
    
    ```jsx
    wget http://sh.xdmb.xyz/tcp.sh && bash tcp.sh
    ```
    

脚本工具箱

- 
    
    ```bash
    bash <(curl -sL kejilion.sh)
    ```
    

## VPS测试

[融合怪](https://github.com/spiritLHLS)

- 
    
    ```bash
    curl -L https://gitlab.com/spiritysdx/za/-/raw/main/ecs.sh -o ecs.sh && chmod +x ecs.sh && bash ecs.sh
    ```
    

[**NodeQuality**](https://www.nodeseek.com/post-297125-1)

- 
    
    ```bash
    bash <(curl -sL https://run.NodeQuality.com)
    ```
    

网络质量检测

- 
    
    ```bash
    bash <(curl -Ls https://Net.Check.Place)
    ```
    

nexttrace

- 
    
    ```bash
    curl -sL nxtrace.org/nt |bash
    nexttrace 1.0.0.1
    ```
    

流媒体测试

- 
    
    ```bash
    bash <(curl -L -s check.unlock.media)
    ```
    

## 节点搭建

3xui

- 
    
    ```bash
    bash <(curl -Ls https://raw.githubusercontent.com/mhsanaei/3x-ui/master/install.sh)
    ```
    
    ```bash
    apt update && apt install -y cron curl && systemctl enable cron && systemctl start cron && curl https://get.acme.sh | sh
    ```
    
    ```bash
    apt update && apt install -y ufw
    ufw allow 22
    ufw allow 4033
    ufw allow 80
    ufw allow 443
    ufw enable
    
    或
    apt update && apt install -y ufw && ufw allow 22 && ufw allow 4033 && ufw allow 80 && ufw allow 443 && ufw --force enable
    
    ufw status
    ```
    

简易节点233boy

- 
    
    ```bash
    bash <(wget -qO- -o- https://github.com/233boy/sing-box/raw/main/install.sh)   #安装
    ```
    
    ```bash
    sb update [core | sh | caddy] [ver]  #sb更新
    ```
    
    ```bash
    bash <(wget -qO- -o- https://github.com/SonthyR/sing-box/raw/main/install.sh) #我的库安装
    ```
    

## 网站搭建

1panel

- 
    
    ```bash
    curl -sSL https://resource.1panel.cn/quick_start.sh -o quick_start.sh && bash quick_start.sh
    ```